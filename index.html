<script>
        // ==========================================
        // 1. Ù…Ø­Ø±Ùƒ Ø§Ù„ØµÙˆØª ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Sound & Data)
        // ==========================================
        
        // Ù†Ø¸Ø§Ù… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£ØµÙˆØ§Øª (Ø¨Ø¯ÙˆÙ† Ù…Ù„ÙØ§Øª mp3 Ù„Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume(); // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª Ù…Ø¹ Ø£ÙˆÙ„ Ù„Ù…Ø³Ø©
            
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            const now = audioCtx.currentTime;

            if (type === 'click') {
                // ØµÙˆØª Ù†Ù‚Ø± Ù†Ø§Ø¹Ù… (Soft Pop)
                osc.type = 'sine';
                osc.frequency.setValueAtTime(600, now);
                osc.frequency.exponentialRampToValueAtTime(300, now + 0.1);
                gainNode.gain.setValueAtTime(0.1, now); // ØµÙˆØª ÙˆØ§Ø·ÙŠ
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                osc.start(now);
                osc.stop(now + 0.1);
            } 
            else if (type === 'flip') {
                // ØµÙˆØª Ø­ÙÙŠÙ Ø§Ù„ÙˆØ±Ù‚ (Whoosh) - Ù…Ø­Ø§ÙƒØ§Ø© Ø¨Ø³ÙŠØ·Ø©
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(200, now);
                gainNode.gain.setValueAtTime(0.05, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.2);
                osc.start(now);
                osc.stop(now + 0.2);
            }
            else if (type === 'win') {
                // ØµÙˆØª Ù†Ø¬Ø§Ø­ Ù‡Ø§Ø¯ÙŠ (Chime)
                osc.type = 'sine';
                osc.frequency.setValueAtTime(500, now);
                osc.frequency.exponentialRampToValueAtTime(1000, now + 0.5);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 1);
                osc.start(now);
                osc.stop(now + 1);
            }
        }

        // --- Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ù…Ø®ØªØµØ±Ø© Ù„Ù„Ø¹Ø±Ø¶ - Ø§Ù†Ø³Ø® Ù…Ø­ØªÙˆØ§Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§) ---
        const db = {
            stage1: [{ t: "b", q: "Ù…Ø³Ø§Ø¨Ù‚Ø© Ù†Ø¸Ø±Ø§Øª." }, {t: "m", q: "Ù†ÙƒØªØ© Ø¨Ø§ÙŠØ®Ø©"}], 
            stage2: [{ t: "b", q: "Ø­Ø¶Ù† Ø¯Ù‚ÙŠÙ‚Ø© ØµÙ…Øª." }],
            stage3: [{ t: "m", q: "Ø¨ÙˆØ³ Ø§Ù„Ø±Ù‚Ø¨Ø©." }],
            stage4: [{ t: "f", q: "Ø§Ù†ØªÙŠ Ø§Ù„Ù…Ù„ÙƒØ©." }],
            prizes: ["Ù…Ø³Ø§Ø¬ ÙƒØ§Ù…Ù„", "ÙØ·Ø§Ø± ÙÙŠ Ø§Ù„Ø³Ø±ÙŠØ±", "Ø¹Ø²ÙˆÙ…Ø© ÙƒØ´Ø±ÙŠ"],
            roleplays: [{ chars: "Ø§Ù„Ø¯ÙƒØªÙˆØ± ÙˆØ§Ù„Ù…Ø±ÙŠØ¶Ø©", wear: "Ø¨Ø§Ù„Ø·Ùˆ", plot: "ÙƒØ´Ù Ø´Ø§Ù…Ù„." }]
        };

        const catchDB = [
            { type: "start", text: "Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©", icon: "ğŸ", desc: "Ù†Ù‚Ø·Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚" },
            { type: "blue", text: "Ø¨ÙˆØ³Ø©", desc: "Ø¨ÙˆØ³Ø© Ø±Ù‚ÙŠÙ‚Ø©", icon: "ğŸ’‹" },
            // ... (Ø£ÙƒÙ…Ù„ Ø§Ù„Ù€ 50 Ù…Ø±Ø¨Ø¹ Ù‡Ù†Ø§)
            { type: "finish", text: "Ø§Ù„Ù†Ù‡Ø§ÙŠØ©", desc: "Ù…Ø¨Ø±ÙˆÙƒ!", icon: "ğŸ‰" }
        ];

        const placesData = [
            { id: 1, name: "Ø§Ù„Ø³Ø±ÙŠØ±", icon: "ğŸ›ï¸" }, { id: 2, name: "Ø§Ù„ÙƒÙ†Ø¨Ø©", icon: "ğŸ›‹ï¸" },
            { id: 3, name: "Ø§Ù„Ù…Ø·Ø¨Ø®", icon: "ğŸ³" }, { id: 4, name: "ØªØ­Øª Ø§Ù„Ø¯Ø´", icon: "ğŸš¿" },
            { id: 5, name: "Ø§Ù„Ø³Ø¬Ø§Ø¯Ø©", icon: "ğŸ§¶" }, { id: 6, name: "Ø§Ù„ÙƒØ±Ø³ÙŠ", icon: "ğŸª‘" },
            { id: 7, name: "Ø§Ù„Ù…Ø±Ø§ÙŠØ§", icon: "ğŸª" }, { id: 8, name: "Ø§Ù„Ø³ÙØ±Ø©", icon: "ğŸ½ï¸" },
            { id: 9, name: "Ø§Ù„ØºØ³Ø§Ù„Ø©", icon: "ğŸ§º" }
        ];

        const wheelSegments = [
            { text: "Ø¨ÙˆØ³Ø©", icon: "ğŸ’‹", color: "#e74c3c", desc: "Ø¨ÙˆØ³Ø© ÙØ±Ù†Ø³ÙŠØ© Ø¹Ù…ÙŠÙ‚Ø©." },
            { text: "Ù…Ø³Ø§Ø¬", icon: "ğŸ’†", color: "#e67e22", desc: "Ù…Ø³Ø§Ø¬ Ù„Ù„Ø±Ù‚Ø¨Ø© 3 Ø¯Ù‚Ø§ÙŠÙ‚." },
            { text: "Ù‡Ù…Ø³", icon: "ğŸ—£ï¸", color: "#f1c40f", desc: "Ù‡Ù…Ø³ ÙÙŠ Ø§Ù„Ø£Ø°Ù†." },
            { text: "Ù„Ø¹Ù‚", icon: "ğŸ‘…", color: "#2ecc71", desc: "Ù…Ø¯Ø§Ø¹Ø¨Ø© Ø¨Ø§Ù„Ù„Ø³Ø§Ù†." },
            { text: "Oral", icon: "ğŸ­", color: "#1abc9c", desc: "Ø¬Ù†Ø³ ÙÙ…ÙˆÙŠ." },
            { text: "Doggy", icon: "ğŸ•", color: "#3498db", desc: "ÙˆØ¶Ø¹ÙŠØ© Ø§Ù„Ø¯ÙˆØ¬ÙŠ." },
            { text: "ØªØ­ÙƒÙ…", icon: "ğŸ‘‘", color: "#9b59b6", desc: "Ø£Ù†Øª Ø§Ù„Ù…Ù„Ùƒ." },
            { text: "69", icon: "â™‹", color: "#8e44ad", desc: "ÙˆØ¶Ø¹ÙŠØ© 69." },
            { text: "ØªØ¹Ø±ÙŠ", icon: "ğŸ‘™", color: "#ff4081", desc: "Ø±Ù‚ØµØ© ØªØ¹Ø±ÙŠ." },
            { text: "Ø¹Ø¶Ø©", icon: "ğŸ§›", color: "#f44336", desc: "Ø¹Ø¶Ø© Ø®ÙÙŠÙØ©." },
            { text: "ÙŠØ¯ÙˆÙŠØ©", icon: "ğŸ‘‹", color: "#ff9800", desc: "Ù…Ø¯Ø§Ø¹Ø¨Ø© ÙŠØ¯ÙˆÙŠØ©." },
            { text: "ÙˆØ§Ù‚Ù", icon: "ğŸ§", color: "#ffeb3b", desc: "Ø¹Ù„Ø§Ù‚Ø© Ø³Ø±ÙŠØ¹Ø©." },
            { text: "ÙØ§Ø±Ø³Ø©", icon: "ğŸ¤ ", color: "#cddc39", desc: "Ø§Ù„Ø²ÙˆØ¬Ø© ØªØªØ­ÙƒÙ…." },
            { text: "Ù…ØºÙ…Ø¶", icon: "ğŸ™ˆ", color: "#009688", desc: "ØºÙ…Ø¶ Ø¹ÙŠÙ†Ùƒ." },
            { text: "Ø£Ø¯Ø§Ø©", icon: "ğŸª¶", color: "#03a9f4", desc: "Ø§Ø³ØªØ®Ø¯Ù… Ø±ÙŠØ´Ø©." },
            { text: "Ø­Ø±ÙŠØ©", icon: "ğŸ˜ˆ", color: "#607d8b", desc: "Ø§ÙØ¹Ù„ Ù…Ø§ ÙŠØ­Ù„Ùˆ Ù„Ùƒ." }
        ];

        const gameInstructions = {
            game1: { title: "1. Ù‡Ø²Ø§Ø± ÙˆÙ†Ø§Ø± ğŸ˜‚", content: `<div class="instr-point"><span class="instr-icon">ğŸ¯</span><div><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> ÙƒØ³Ø± Ø§Ù„Ù…Ù„Ù„ ÙˆØ§Ù„Ø¶Ø­Ùƒ.</div></div>`, action: () => startGame('stage1') },
            game2: { title: "2. Ø­Ø¨ ÙˆÙ‚Ø±Ø¨ â¤ï¸", content: `<div class="instr-point"><span class="instr-icon">ğŸ¯</span><div><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ©.</div></div>`, action: () => startGame('stage2') },
            game3: { title: "3. Ø£Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø±ÙƒØ© âš”ï¸", content: `<div class="instr-point"><span class="instr-icon">ğŸ¯</span><div><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙƒØ§Ù†.</div></div>`, action: () => startEliminationGame() },
            game4: { title: "4. Ù‡Ù…Ø³ ÙˆÙ„Ù…Ø³ ğŸ”¥", content: `<div class="instr-point"><span class="instr-icon">ğŸ¯</span><div><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> Ø§Ù„ØªØ³Ø®ÙŠÙ† ÙˆØ§Ù„Ù…Ø¯Ø§Ø¹Ø¨Ø©.</div></div>`, action: () => startGame('stage3') },
            game5: { title: "5. Ù†Ø§Ø± ÙˆØ¯Ù…Ø§Ø± ğŸ”", content: `<div class="instr-point"><span class="instr-icon">ğŸ¯</span><div><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> Ù‚Ù…Ø© Ø§Ù„Ù…ØªØ¹Ø©.</div></div>`, action: () => startGame('stage4') },
            game6: { title: "6. ØªÙ…Ø«ÙŠÙ„ Ø³Ø§Ø®Ù† ğŸ­", content: `<div class="instr-point"><span class="instr-icon">ğŸ¯</span><div><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> ØªÙ‚Ù…Øµ Ø£Ø¯ÙˆØ§Ø±.</div></div>`, action: () => startRoleplay() },
            game7: { title: "7. Ø±Ø­Ù„Ø© Ø§Ù„Ù…ØªØ¹Ø© ğŸ²", content: `<div class="instr-point"><span class="instr-icon">ğŸ¯</span><div><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù†Ù‡Ø§ÙŠØ©.</div></div>`, action: () => startCatchMe() },
            game8: { title: "8. Ø¹Ø¬Ù„Ø© Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹ ğŸ¡", content: `<div class="instr-point"><span class="instr-icon">ğŸ¯</span><div><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ.</div></div>`, action: () => startSpinGame() },
            game9: { title: "9. Ø¯Ù„Ø¹ ÙˆÙˆÙ„Ø¹ ğŸ", content: `<div class="instr-point"><span class="instr-icon">ğŸ¯</span><div><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø®ØªØ§Ù….</div></div>`, action: () => initScratch() }
        };

        // ==========================================
        // 2. CORE LOGIC & SAVE SYSTEM (Ù†Ø¸Ø§Ù… Ø§Ù„Ø­ÙØ¸)
        // ==========================================
        let currentQ = [];
        let activeStage = "";

        // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹
        window.onload = function() {
            // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            if(localStorage.getItem('hn_login') === 'true') {
                show('dashboard', false); // false ØªØ¹Ù†ÙŠ Ø¨Ø¯ÙˆÙ† ØµÙˆØª
            }

            // 2. Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ØªÙ‚Ø¯Ù… Ù„Ø¹Ø¨Ø© Catch Me
            const savedP1 = localStorage.getItem('hn_catch_p1');
            const savedP2 = localStorage.getItem('hn_catch_p2');
            const savedTurn = localStorage.getItem('hn_catch_turn');
            
            if(savedP1) catchPlayers[0].pos = parseInt(savedP1);
            if(savedP2) catchPlayers[1].pos = parseInt(savedP2);
            if(savedTurn) cTurn = parseInt(savedTurn);
        };

        function show(id, withSound = true) {
            if(withSound) playSound('click');
            document.querySelectorAll('.screen').forEach(s => { 
                if(s.id !== id) {
                    s.classList.remove('active'); 
                    setTimeout(()=> { if(!s.classList.contains('active')) s.style.display='none'; }, 300); 
                }
            });
            const el = document.getElementById(id); el.style.display = 'flex'; setTimeout(()=>el.classList.add('active'), 10);
        }

        function login() {
            const val = document.getElementById('pass').value;
            if(val==="1234" || val==="HOT") {
                localStorage.setItem('hn_login', 'true'); // Ø­ÙØ¸ Ø§Ù„Ø¯Ø®ÙˆÙ„
                show('dashboard');
            }
            else document.getElementById('error').style.display='block';
        }

        function goHome() { show('dashboard'); }
        function openGuide() { playSound('click'); document.getElementById('modal-guide').classList.add('show'); }
        function closeGuide() { playSound('click'); document.getElementById('modal-guide').classList.remove('show'); }
        
        function openInstructions(gameId) {
            playSound('click');
            const data = gameInstructions[gameId];
            if(!data) return;
            document.getElementById('instr-title').innerText = data.title;
            document.getElementById('instr-body').innerHTML = data.content;
            const btn = document.getElementById('instr-start-btn');
            btn.onclick = () => {
                playSound('click');
                document.getElementById('instructions-screen').classList.remove('show');
                data.action();
            };
            document.getElementById('instructions-screen').classList.add('show');
        }

        // ==========================================
        // 3. GAME FUNCTIONS
        // ==========================================
        function startGame(stg) {
            activeStage = stg;
            currentQ = [...db[stg]].sort(() => Math.random() - 0.5); 
            let title = "";
            if(stg=='stage1') title="1. Ù‡Ø²Ø§Ø± ÙˆÙ†Ø§Ø± ğŸ˜‚";
            if(stg=='stage2') title="2. Ø­Ø¨ ÙˆÙ‚Ø±Ø¨ â¤ï¸";
            if(stg=='stage3') title="4. Ù‡Ù…Ø³ ÙˆÙ„Ù…Ø³ ğŸ”¥";
            if(stg=='stage4') title="5. Ù†Ø§Ø± ÙˆØ¯Ù…Ø§Ø± ğŸ”";
            document.getElementById('g-header').innerText = title;
            document.getElementById('card-obj').classList.remove('flipped');
            show('gameplay');
        }

        function flip() {
            playSound('flip');
            const c = document.getElementById('card-obj');
            if(c.classList.contains('flipped')) { c.classList.remove('flipped'); setTimeout(updTxt, 300); }
            else { updTxt(); c.classList.add('flipped'); }
        }

        function updTxt() {
            if(!db[activeStage]) return;
            if(currentQ.length===0) currentQ = [...db[activeStage]].sort(()=>Math.random()-0.5);
            const item = currentQ.pop();
            const textDiv = document.getElementById('q-text');
            let roleHtml = "";
            if(item.t === 'm') roleHtml = "<div style='color:#00a8ff; font-size:1rem; margin-bottom:10px;'>ğŸ‘¨ Ø¯ÙˆØ± Ø§Ù„Ø²ÙˆØ¬</div>";
            else if(item.t === 'f') roleHtml = "<div style='color:#ff007f; font-size:1rem; margin-bottom:10px;'>ğŸ‘© Ø¯ÙˆØ± Ø§Ù„Ø²ÙˆØ¬Ø©</div>";
            else roleHtml = "<div style='color:#d4af37; font-size:1rem; margin-bottom:10px;'>ğŸ‘« Ù„ÙŠÙƒÙ… Ø³ÙˆØ§</div>";
            textDiv.innerHTML = roleHtml + item.q;
        }

        function startRoleplay() { show('roleplay-area'); genRoleplay(); }
        function genRoleplay() {
            playSound('flip');
            const rp = db.roleplays[Math.floor(Math.random() * db.roleplays.length)];
            document.getElementById('rp-chars').innerText = rp.chars;
            document.getElementById('rp-wear').innerText = rp.wear;
            document.getElementById('rp-plot').innerText = rp.plot;
        }

        let cvs, ctx, drawing=false;
        function initScratch() { show('scratch-area'); setTimeout(resetScratch, 100); }
        function resetScratch() {
            cvs = document.getElementById('cvs'); ctx = cvs.getContext('2d');
            const p = cvs.parentElement; cvs.width = p.offsetWidth; cvs.height = p.offsetHeight;
            document.getElementById('prize-txt').innerText = db.prizes[Math.floor(Math.random()*db.prizes.length)];
            ctx.globalCompositeOperation='source-over'; ctx.fillStyle='#bbb'; ctx.fillRect(0,0,cvs.width,cvs.height);
            ctx.fillStyle='#fff'; ctx.font='bold 20px Cairo'; ctx.textAlign='center'; ctx.fillText("Ø§Ø®Ø±Ø¨Ø´ Ù‡Ù†Ø§", cvs.width/2, cvs.height/2+8);
            ctx.globalCompositeOperation='destination-out';
        }
        
        // ØªØµØ­ÙŠØ­ Ø§Ù„Ù„Ù…Ø³
        document.addEventListener('mousedown', (e) => { if(e.target.id === 'cvs') drawing = true; });
        document.addEventListener('touchstart', (e) => { if(e.target.id === 'cvs') drawing = true; });
        document.addEventListener('mouseup', () => drawing = false);
        document.addEventListener('touchend', () => drawing = false);
        document.addEventListener('mousemove', (e) => { if(cvs && drawing) scratch(e); });
        document.addEventListener('touchmove', (e) => { 
            if(cvs && drawing && e.target.id === 'cvs') { e.preventDefault(); scratch(e); }
        }, { passive: false });

        function scratch(e) {
            const r = cvs.getBoundingClientRect();
            const x = (e.touches?e.touches[0].clientX:e.clientX)-r.left;
            const y = (e.touches?e.touches[0].clientY:e.clientY)-r.top;
            ctx.beginPath(); ctx.arc(x,y,20,0,Math.PI*2); ctx.fill();
        }

        // --- Elimination ---
        let activePlacesCount = 9; let elimTurn = 0; 
        function startEliminationGame() { show('elimination-area'); resetElimination(); }
        function resetElimination() {
            const grid = document.getElementById('places-grid'); grid.innerHTML = "";
            activePlacesCount = 9; elimTurn = 0;
            updateElimTurnUI();
            document.getElementById('reset-elim-btn').style.display = 'none';
            placesData.forEach(p => {
                const card = document.createElement('div'); card.className = 'place-card'; card.id = `p-${p.id}`;
                card.onclick = () => eliminatePlace(p.id);
                card.innerHTML = `<div class="place-icon">${p.icon}</div><div class="place-name">${p.name}</div>`;
                grid.appendChild(card);
            });
        }
        function eliminatePlace(id) {
            if (activePlacesCount <= 1) return;
            const card = document.getElementById(`p-${id}`);
            if (card.classList.contains('eliminated')) return;
            playSound('click'); // ØµÙˆØª Ø§Ù„Ø­Ø°Ù
            card.classList.add('eliminated'); activePlacesCount--;
            elimTurn = (elimTurn === 0) ? 1 : 0; updateElimTurnUI();
            if (activePlacesCount === 1) declareWinnerPlace();
        }
        function updateElimTurnUI() {
            const banner = document.getElementById('elim-turn');
            if (elimTurn === 0) { banner.innerText = "Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„Ù‰: Ø§Ù„Ø²ÙˆØ¬ ğŸ‘¨ (Ø§Ø­Ø°Ù Ù…ÙƒØ§Ù†)"; banner.style.color = "#00bfff"; banner.style.borderColor = "#00bfff"; }
            else { banner.innerText = "Ø§Ù„Ø¯ÙˆØ± Ø¹Ù„Ù‰: Ø§Ù„Ø²ÙˆØ¬Ø© ğŸ‘© (Ø§Ø­Ø°ÙÙŠ Ù…ÙƒØ§Ù†)"; banner.style.color = "#ff007f"; banner.style.borderColor = "#ff007f"; }
        }
        function declareWinnerPlace() {
            const allCards = document.querySelectorAll('.place-card'); let winnerText = "";
            allCards.forEach(card => { if (!card.classList.contains('eliminated')) { card.classList.add('winner'); winnerText = card.querySelector('.place-name').innerText; } });
            const banner = document.getElementById('elim-turn'); banner.innerText = `ğŸ‰ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø®ØªØ§Ø±: ${winnerText}`; banner.style.color = "#d4af37"; banner.style.borderColor = "#d4af37";
            document.getElementById('reset-elim-btn').style.display = 'block';
            playSound('win');
            if(navigator.vibrate) navigator.vibrate([100, 50, 100]);
        }

        // --- Catch Me (Auto-Save Enabled) ---
        const catchPlayers = [ { name: "Ø§Ù„Ø²ÙˆØ¬", icon: "ğŸ‘¨", pos: 0, css: "p1-token" }, { name: "Ø§Ù„Ø²ÙˆØ¬Ø©", icon: "ğŸ‘©", pos: 0, css: "p2-token" } ];
        let cTurn = 0; let boardCreated = false;

        function startCatchMe() { show('catch-game-area'); if(!boardCreated) { createCatchBoard(); boardCreated = true; } }

        function createCatchBoard() {
            const board = document.getElementById('board'); board.innerHTML = "";
            let row = document.createElement('div'); row.className = 'row';
            for (let i = 50; i >= 0; i--) {
                const sqData = catchDB[i] || catchDB[catchDB.length-1];
                let z = ''; if(i===0||i===50) z='finish-zone'; else if(i<=12) z='blue-zone'; else if(i<=25) z='purple-zone'; else if(i<=37) z='pink-zone'; else z='red-zone';
                const sq = document.createElement('div'); sq.className = `square ${z}`; sq.id = `sq-${i}`; sq.innerHTML = i===0 ? "Start" : i;
                row.appendChild(sq);
                if((50-i+1)%5===0 || i===0) { board.appendChild(row); row = document.createElement('div'); row.className = 'row'; }
            }
            updateTokens();
        }
        function updateTokens() {
            document.querySelectorAll('.player-token').forEach(e=>e.remove());
            catchPlayers.forEach(p => {
                const sq = document.getElementById(`sq-${p.pos}`);
                if(sq) { const t = document.createElement('div'); t.className = `player-token ${p.css}`; sq.appendChild(t); }
            });
        }
        function rollCatchDice() {
            playSound('click');
            const btn = document.getElementById('catch-dice'); if(btn.classList.contains('rolling')) return;
            btn.innerText = "ğŸ²"; btn.classList.add('rolling');
            setTimeout(() => {
                const r = Math.floor(Math.random()*6)+1; btn.innerText = r; btn.classList.remove('rolling');
                moveCatchPlayer(r);
            }, 600);
        }
        function moveCatchPlayer(steps) {
            const p = catchPlayers[cTurn]; let moved = 0;
            const intv = setInterval(() => {
                if(p.pos < 50) { 
                    p.pos++; 
                    updateTokens(); 
                    moved++; 
                    // Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø®Ø·ÙˆØ©
                    localStorage.setItem('hn_catch_p1', catchPlayers[0].pos);
                    localStorage.setItem('hn_catch_p2', catchPlayers[1].pos);
                }
                if(moved >= steps || p.pos >= 50) { 
                    clearInterval(intv); 
                    setTimeout(()=>showCatchChallenge(p.pos), 500); 
                }
            }, 300);
        }
        function showCatchChallenge(pos) {
            playSound('win');
            if(pos === 0) { switchCTurn(); return; }
            const data = catchDB[pos] || catchDB[catchDB.length-1];
            const modal = document.getElementById('catch-modal'); const content = document.getElementById('catch-card-content');
            let color = 'var(--primary)'; if(data.type === 'blue') color = 'var(--blue)'; if(data.type === 'purple') color = 'var(--purple)'; if(data.type === 'pink') color = '#ff00cc'; if(data.type === 'red') color = 'var(--accent)';
            content.style.borderColor = color;
            content.innerHTML = `<div class="catch-icon">${data.icon}</div><div class="catch-title" style="color:${color}">${data.text}</div><div class="catch-desc">${data.desc}</div><button class="btn-gold" style="background:${color}; border:none;" onclick="closeCatchModal()">Ù†ÙØ°Ù†Ø§ ğŸ˜‰</button>`;
            modal.style.display = 'flex';
        }
        function closeCatchModal() {
            playSound('click');
            document.getElementById('catch-modal').style.display = 'none';
            if(catchPlayers[cTurn].pos >= 50) { 
                alert(`Ù…Ø¨Ø±ÙˆÙƒ! ${catchPlayers[cTurn].name} ÙƒØ³Ø¨ Ø§Ù„Ù„ÙŠÙ„Ø©! ğŸ‰`); 
                catchPlayers[0].pos=0; catchPlayers[1].pos=0; updateTokens(); cTurn=0; 
                // ØªØµÙÙŠØ± Ø§Ù„Ø­ÙØ¸ Ø¹Ù†Ø¯ Ø§Ù„ÙÙˆØ²
                localStorage.removeItem('hn_catch_p1'); localStorage.removeItem('hn_catch_p2');
            } else { switchCTurn(); }
        }
        function switchCTurn() { 
            cTurn = (cTurn === 0) ? 1 : 0; 
            localStorage.setItem('hn_catch_turn', cTurn); // Ø­ÙØ¸ Ø§Ù„Ø¯ÙˆØ±
            const p = catchPlayers[cTurn]; 
            document.getElementById('catch-player').innerText = `${p.name} ${p.icon}`; 
            document.getElementById('catch-pos').innerText = p.pos===0?"Start":p.pos; 
        }

        // --- Spin Wheel ---
        let wheelCreated = false; let currentRotation = 0; let spinTurn = 0; 
        const spinPlayers = [ { name: "Ø§Ù„Ø²ÙˆØ¬", icon: "ğŸ‘¨" }, { name: "Ø§Ù„Ø²ÙˆØ¬Ø©", icon: "ğŸ‘©" } ];
        function startSpinGame() { show('spin-game-area'); if (!wheelCreated) { createWheelClean(); wheelCreated = true; } updateSpinUI(); }
        function updateSpinUI() { const p = spinPlayers[spinTurn]; document.getElementById('spin-player').innerText = `${p.name} ${p.icon}`; }
        function createWheelClean() {
            let gradientString = "conic-gradient("; const segmentSize = 360 / wheelSegments.length; 
            wheelSegments.forEach((seg, i) => { const startDeg = i * segmentSize; const endDeg = (i + 1) * segmentSize; gradientString += `${seg.color} ${startDeg}deg ${endDeg}deg${i < wheelSegments.length - 1 ? ',' : ''}`; });
            gradientString += ")"; document.getElementById('wheel-bg').style.background = gradientString;
            const iconContainer = document.getElementById('wheel-icons');
            wheelSegments.forEach((seg, i) => {
                const box = document.createElement('div'); box.className = 'icon-box';
                const midAngle = (i * segmentSize) + (segmentSize / 2);
                box.style.transform = `rotate(${midAngle}deg)`;
                box.innerHTML = `<div class="icon-content" style="transform: rotate(90deg);">${seg.icon}</div>`;
                iconContainer.appendChild(box);
            });
        }
        function spinWheel() {
            const bg = document.getElementById('wheel-bg'); const icons = document.getElementById('wheel-icons');
            const spinBtn = document.querySelector('#spin-game-area .btn-gold'); if(spinBtn.disabled) return;
            playSound('click');
            spinBtn.disabled = true; const randomDeg = Math.floor(1800 + Math.random() * 1800); currentRotation += randomDeg;
            bg.style.transform = `rotate(${currentRotation}deg)`; icons.style.transform = `rotate(${currentRotation}deg)`;
            setTimeout(() => {
                const numSegments = wheelSegments.length; const segAngle = 360 / numSegments;
                const actualDeg = currentRotation % 360; const winningAngle = (360 - actualDeg) % 360;
                const winningIndex = Math.floor(winningAngle / segAngle);
                showWheelResult(wheelSegments[winningIndex]); spinBtn.disabled = false;
            }, 4000); 
        }
        function showWheelResult(res) { 
            playSound('win');
            const modal = document.getElementById('wheel-modal'); document.getElementById('wheel-result-icon').innerText = res.icon; document.getElementById('wheel-result-title').innerText = res.text; document.getElementById('wheel-result-desc').innerText = res.desc; modal.style.display = 'flex'; 
        }
        function closeWheelModal() { 
            playSound('click');
            document.getElementById('wheel-modal').style.display = 'none'; spinTurn = (spinTurn === 0) ? 1 : 0; updateSpinUI(); 
        }

    </script>
